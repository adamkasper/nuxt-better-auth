---
title: NuxtHub
description: Automatic database setup with schema generation and seamless Drizzle ORM integration.
---

NuxtHub provides the easiest way to add database persistence to your authentication. When enabled, this module automatically generates and manages your database schema.

## Features

- **Auto Schema Generation** - Tables for users, sessions, accounts created automatically
- **Plugin-Aware** - Schema updates when you add plugins like `twoFactor`, `passkey`
- **Multi-Dialect** - SQLite, PostgreSQL, or MySQL
- **Secondary Storage** - Optional KV storage for session caching
- **Zero Config Migrations** - Use `nuxthub migrate` for production

## Setup

::steps

### Install NuxtHub

```bash
pnpm add @nuxthub/core
```

### Configure nuxt.config.ts

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: [
    '@nuxthub/core',
    '@onmax/nuxt-better-auth'
  ],

  hub: {
    db: 'sqlite' // 'sqlite' | 'postgresql' | 'mysql'
  }
})
```

### Restart Dev Server

The schema is generated at build time. Restart after configuration changes.

::

## Database Dialects

Configure your dialect in `hub.db`:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: {
      dialect: 'postgresql' // or 'sqlite', 'mysql'
    }
  }
})
```

## Secondary Storage (KV)

Enable KV storage for faster session lookups:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  hub: {
    db: 'sqlite',
    kv: true
  },

  auth: {
    secondaryStorage: true
  }
})
```

This caches sessions in NuxtHub KV, reducing database hits.

## Production Migrations

For production deployments:

1. Push your changes to your repository
2. Run `nuxthub migrate` to apply schema changes
3. Deploy your application

::callout{icon="i-lucide-book" to="https://hub.nuxt.com/docs/features/database"}
See [NuxtHub Database docs](https://hub.nuxt.com/docs/features/database) for more details.
::

## Schema Generation Details

The module analyzes your `server/auth.config.ts` at build time:

1. **Reads plugins** from your config
2. **Generates Drizzle schema** matching your dialect
3. **Injects into NuxtHub** via `hub:db:schema:extend` hook

::callout{icon="i-lucide-alert-triangle" color="warning"}
**Restart Required**: After adding/removing plugins that affect database structure, restart the dev server to regenerate the schema.
::

## Accessing the Database

With NuxtHub, you get access to the Drizzle database instance in your server config:

```ts [server/auth.config.ts]
export default defineServerAuth(({ db }) => ({
  // db is the Drizzle instance from NuxtHub
}))
```
